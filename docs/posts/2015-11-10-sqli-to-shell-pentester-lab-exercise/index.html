<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>SQLi to Shell - Pentester Lab Exercise - Pwn October: A Technology Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Pwn October: A Technology Blog" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Pwn October: A Technology Blog</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQLi to Shell - Pentester Lab Exercise</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">Mark Koskei</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2015-11-09T06:19:11&#43;03:00">November 09, 2015</time></div></div>
		</header><div class="content post__content clearfix">
			<p>The <a href="https://pentesterlab.com/exercises/from_sqli_to_shell/">exercise</a> requires us to leverage SQL injection (SQLi) to gain shell access on a vulnerable web application.</p>
<p>A live image for a Unix-like operating system was provided and accessing the device through a browser gives us a simple website.</p>
<h3 id="fingerprinting">Fingerprinting</h3>
<p>Fingerprinting refers to the gathering information from the target system.</p>
<p>Examining the URLs in the web browser or alternatively inspecting the received HTTP headers reveals that the website was written in PHP.</p>
<p>On further investigation, a HTTP GET request returns the version of PHP running, the web server and the version of operating system.</p>
<p>OpenSSL returns nothing indicating that the application is not available over HTTPS.</p>
<h3 id="detecting-sql-injection">Detecting SQL Injection</h3>
<p>From the target website, we can see a pattern of how pages are returned as shown in the snippet below.</p>
<p><code>/cat.php?id=n</code></p>
<p>The value n refers to an integer value which returns a different page depending on the user input.</p>
<p>A simple test for SQLi could then involve inserting the sample statement into the URL field:</p>
<p><code>SELECT * FROM articles WHERE id=2-1;</code></p>
<p>If the given query returns article 1, this implies that the application is running calculations on the database. This is referred to as detection based on integers.</p>
<p>Alternatively, we can test for SQLi based on strings. This relies on the fact that SQL strings are put in between quotes and a single quote will break a query.</p>
<p>A test for this type of vulnerability can be done by inserting a simple query where SQL would expect a variable.</p>
<p>As an example the statement below would return all values from the table. This is because the statement &ldquo;1=1&rdquo; returns the value &ldquo;True&rdquo;.</p>
<p><code>SELECT * FROM users WHERE name = '' OR '1'='1';</code></p>
<h3 id="exploitation">Exploitation</h3>
<p>Based on the results of the detection stage, we can prove an SQL injection exists in our web application.</p>
<p>Therefore our objective becomes the retrieval of additional information from within the database. To achieve this the SQL operation, UNION can be leveraged to return information stored in other tables.</p>
<p>The result of this section of the exercise is a username and hashed password for a privileged (administrator) account on the web application.</p>
<p>Information gathered in the fingerprinting stage reveals that the query language used is MySQL which means the use of MD5 or SHA1 hashing function for the password.</p>
<p>Using this information, we can crack the hash using John the Ripper. Alternatively, an online search should return quick (and online) password hashing tools or dumps with matching cleartext and hash values.</p>
<p>Our returned username and password should allow us enhanced access to the web application.</p>
<p>From the fingerprinting stage, we know that the web server is running Squeeze; a version of the Debian distro.</p>
<p>Using this information, the objective becomes attempting to upload a php script through which we can access the Bash shell. With a successful upload of the script, we are able to run Bash commands through the URL and thus completing the exercise.</p>
<h3 id="conclusion">Conclusion</h3>
<p>The exercise above is provided by Pentester Lab and can be attempted <a href="https://pentesterlab.com/exercises/from_sqli_to_shell">here</a>.</p>

		</div>
	</article>
</main>

<div class="authorbox clearfix">
	<div class="authorbox__header">
		<span class="authorbox__name"></span>
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2015-10-23-problem-3-project-euler/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Problem 3 - Project Euler</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2015-11-10-sqli-to-shell-mitigation-measures/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQLi to Shell - Mitigation Measures</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2022 Pwn October: A Technology Blog.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>